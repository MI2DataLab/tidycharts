---
title: "Getting_Started"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Getting_Started}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

This vignette shows the usage of the ibcsplot package. It contains different chart types examples and tips for proper data visualization.

## Prerequisites
This package and vignette are created for a user who:

* has basic programming skills in R
* is familiar with R data structures, such as vector, data.frame

# How to download and install the package?

```{r setup, message=FALSE}

# install from CRAN
# install.packages(ibcsplot)

library(ibcsplot)

```

# Bar charts

## Data

Bar charts shoud be used to show structure in one moment of time. One of typical usecase of the barchart is to visualize profit of a company in a division by departments. The data structure could look the following:

```{r data}
data_barchart <- data.frame(
  dep = c('Services', 'Production', 'Marketing', 'Purchasing'),
  profit = c(12, 15, 2, -3),
  operational = c(9, 7, 1.5, -0.4),
  property = c(2, 4, 0.5, -0.6),
  bonus = c(1, 4, 0, -2),
  prev_year = c(10, 16, 4, -1),
  plan = c(11, 13, 2, -2.5)
)
```

In the example data `operational`, `property` and `bonus` are parts of `profit` and sum up to it.

## Basic

Creation of the barchart is simple. We use `barchart_plot` function to do that. After calling the function, `SVGrenderer()` should be used to render the plot as HTML content. Otherwise one element character vector with SVG content is returned. We can chain the commands by pipe operator (`%>%`).

```{r base-barchart}

barchart_plot(data = data_barchart, cat = data_barchart$dep, series = 'profit') %>% 
  SVGrenderer()

```

A plot should contain an informative title. We can use `add_title` function to make one. As with `SVGRenderer`, we chain the commands. 

```{r barchart-title}
barchart_plot(data = data_barchart, cat = data_barchart$dep, series = 'profit') %>% 
  add_title('The company XYZ', 'Profit', 'in mEUR', 'by departments, 2020') %>% 
  SVGrenderer()
```

We can show the structure of each value by specyfing different `series` argument. It can be a vector of column names. It that case, stacked barchart will be generated.

```{r barchart-stacked}
barchart_plot(data = data_barchart, cat = data_barchart$dep, 
              series = c('operational', 'property', 'bonus')) %>%  
  add_title('The company XYZ', 'Profit', 'in mEUR', 'by departments, 2020') %>% 
  SVGrenderer()
```

## Normalized

Normalized barplot should be used to show the proportions of parts in each category. Typical intention of using this kind of plot could be to visualize the percentage structure of profit among different departments in a company.

```{r barchart-normalized}
barchart_plot_normalized(data = data_barchart, cat = data_barchart$dep,
                         series = c('operational', 'property', 'bonus')) %>% 
  SVGrenderer()
```

## Indexed

We use indecies to show a reference value on the plot. In the following example, index line is used to show the best result in previous year (PY). 

```{r barchart-index}
barchart_plot_index(data = data_barchart,
                    cat = data_barchart$dep, series = 'profit', 
                    index_val = 10, index_label = 'PY best result') %>% 
  SVGrenderer()
```

## Grouped

To visualize 2 or 3 series of data, which **do not** sum up to some value, grouped barchart should be used. First series is visualized by bars in the foreground, second by bars in the background and third in the form of triangles. Style of the bars and triangles indicates type of data, so called scenerios. 

The most typical usecase of this chart is to visualize profit of different departments in a company with comparison to bugdet and previous year data.

```{r barchart-grouped}

styles <- data.frame(profit = rep('actual', 4),
                     plan = rep('plan', 4),
                     prev_year = rep('previous',4))

barchart_plot_grouped(data = data_barchart,
                      cat = data_barchart$dep, series = c('prev_year', 'profit', 'plan'),
                      series_labels = c('PY', 'AC', 'PL'), df_styles = styles) %>% 
  SVGrenderer()
```

## Variances

Show variance in data using relative variance plots or absolute variance plots. Define the baseline and the real values. Axis on variance plots use styles to scenario of baseline data. Relative variance plot shows difference in percents and absolute variance plot shows it in base units.

Example usage: Visualize difference between two scenarios in division by departments.

```{r barchart-variances}
barchart_plot_absolute_variance(cat = data_barchart$dep, 
                                baseline = data_barchart$plan,
                                real = data_barchart$profit,
                                y_title = 'Plan vs. actual',
                                y_style = 'plan') %>% 
  SVGrenderer()

barchart_plot_relative_variance(cat = data_barchart$dep, 
                                baseline = data_barchart$plan,
                                real = data_barchart$profit,
                                y_title = 'Plan vs. actual',
                                y_style = 'plan') %>% 
  SVGrenderer()

```

## Join plots

Combining plots in one grid is useful and easy by using the function `join_plots`.

```{r barchart-join}

join_plots(
  barchart_plot_grouped(data = data_barchart,
                      cat = data_barchart$dep, series = c('prev_year', 'profit', 'plan'),
                      series_labels = c('PY', 'AC', 'PL'), df_styles = styles),
  barchart_plot_absolute_variance(cat = data_barchart$dep, 
                                baseline = data_barchart$plan,
                                real = data_barchart$profit,
                                y_title = 'Plan vs. actual',
                                y_style = 'plan'),
  barchart_plot_relative_variance(cat = data_barchart$dep, 
                                baseline = data_barchart$plan,
                                real = data_barchart$profit,
                                y_title = 'Plan vs. actual',
                                y_style = 'plan'),
  nrows = 1,
  ncols = 3
) %>% SVGrenderer()
```

